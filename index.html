<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ZynoXx êœã‚ - Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</title>
<link rel="icon" href="data:;base64,=">
<style>
:root{
  --bg: #0b1220;
  --card: #07122a;
  --accent: #06b6d4;
  --muted: #9fb0c3;
  --glass: rgba(255,255,255,0.03);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family: Inter, "Segoe UI", Tahoma, sans-serif;
  background: linear-gradient(180deg,#071024 0%, #071827 70%);
  color:#e6eef8;
  padding:18px;
  direction:rtl;
}
.container{max-width:1100px;margin:0 auto}
.header{
  display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:18px;
}
.brand{display:flex;gap:12px;align-items:center}
.logo{
  width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#0ea5a6);
  display:flex;align-items:center;justify-content:center;font-weight:800;color:#021022;font-size:18px;
}
.title{font-size:20px;font-weight:800}
.subtitle{color:var(--muted);font-size:13px;margin-top:3px}

.controls{display:flex;gap:8px;align-items:center}
.btn{
  background:var(--accent);border:none;padding:9px 12px;border-radius:10px;color:#021022;font-weight:700;cursor:pointer;
}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
.search{
  background:var(--glass);padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);color:var(--muted);min-width:180px
}

.grid{
  display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px;margin-top:18px;
}

.card{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius:12px;padding:12px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:10px;
  transition:transform .18s, box-shadow .18s;
}
.card:hover{transform:translateY(-6px);box-shadow:0 12px 30px rgba(2,10,22,0.6)}
.card img{width:100%;height:160px;object-fit:cover;border-radius:8px}
.card h3{margin:0;font-size:16px}
.meta{display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-size:13px}
.price{font-weight:800;color:#b7f8ff}
.qty{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:8px;font-size:13px}

.card .actions{display:flex;gap:8px}
.addCart{flex:1;background:var(--accent);border:none;padding:10px;border-radius:9px;color:#021022;font-weight:700;cursor:pointer}
.infoBtn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:9px;color:var(--muted);cursor:pointer}

.cartBox{
  position: fixed; left: 18px; bottom: 18px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.03); padding:12px; border-radius:12px; width:320px;
}
.cartHeader{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.cartItems{max-height:260px;overflow:auto;margin-bottom:8px}
.cartItem{display:flex;gap:8px;align-items:center;border-bottom:1px dashed rgba(255,255,255,0.02);padding:8px 0}
.cartItem img{width:54px;height:44px;object-fit:cover;border-radius:6px}
.sendOrder{background:linear-gradient(90deg,#06b6d4,#0ea5a6);border:none;padding:10px;border-radius:9px;color:#021022;font-weight:800;cursor:pointer;width:100%}

small.hint{color:var(--muted);display:block;margin-top:6px;text-align:center;font-size:12px}
.badge{background:#05202a;padding:6px 8px;border-radius:999px;font-weight:700;color:#7ee7ef}
@media(max-width:600px){.cartBox{width:92%;left:4%;right:4%}}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="brand">
      <div class="logo">Zy</div>
      <div>
        <div class="title">ZynoXx êœã‚</div>
        <div class="subtitle">Ù…ØªØ¬Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª Ø¹ØµØ±ÙŠ â€” Ø§Ø·Ù„Ø¨ Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù…</div>
      </div>
    </div>

    <div class="controls">
      <input id="search" class="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬..." />
      <button id="adminOpen" class="btn ghost">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
      <button id="refreshBtn" class="btn">ØªØ­Ø¯ÙŠØ«</button>
    </div>
  </div>

  <div id="grid" class="grid"></div>
  <div id="noProducts" style="display:none;color:var(--muted);text-align:center;margin-top:30px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¹Ø¯. Ø§ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø£Ùˆ Ø§Ø±ÙØ¹ Ù…Ù„Ù <code>products.json</code>.</div>
</div>

<!-- Ø³Ù„Ø© -->
<div id="cart" class="cartBox" style="display:none">
  <div class="cartHeader">
    <div><strong>Ø§Ù„Ø³Ù„Ø©</strong> <span id="cartCount" class="badge">0</span></div>
    <div><button id="closeCart" class="infoBtn">Ø¥ØºÙ„Ø§Ù‚</button></div>
  </div>
  <div class="cartItems" id="cartItems"></div>
  <div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
      <div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</div>
      <div id="cartTotal" style="font-weight:800">0 DA</div>
    </div>
    <button id="sendOrderBtn" class="sendOrder">Ø£Ø±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„ØªÙ„Ø¬Ø±Ø§Ù…</button>
    <small class="hint">Ø³ÙŠØµÙ„Ùƒ Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.</small>
  </div>
</div>

<!-- Admin modal -->
<div id="adminModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;padding:20px">
  <div style="background:#061024;padding:16px;border-radius:12px;max-width:600px;width:100%">
    <h3 style="margin:0 0 8px 0">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¨Ø³ÙŠØ·Ø©</h3>
    <p style="color:var(--muted);margin-top:0">Ù„Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ø³ØªØ¹Ù…Ù„ Ù…Ù„Ù <code>products.json</code> ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø£Ùˆ Ø±Ø¨Ø· Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù… (Auto).</p>
    <div style="display:flex;gap:8px;margin-bottom:8px">
      <input id="adminSecret" placeholder="Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø¯ÙŠØ± (secret)" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
      <button id="adminLoad" class="btn">ØªØ­Ù…ÙŠÙ„</button>
      <button id="adminClose" class="infoBtn">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
    <div style="margin-top:8px;color:var(--muted);font-size:13px">
      <div>Ø£ÙˆØ§Ù…Ø± Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù… Ù„ØªØ­Ø¯ÙŠØ« (Ù…Ø«Ø§Ù„):</div>
      <ul>
        <li><code>/add|Ø§Ø³Ù…|Ø§Ù„Ø³Ø¹Ø±|Ø§Ù„ÙƒÙ…ÙŠØ©|Ø±Ø§Ø¨Ø·_Ø§Ù„ØµÙˆØ±Ø©</code></li>
        <li><code>/del|Ø§Ø³Ù…</code></li>
        <li><code>/edit|Ø§Ø³Ù…|Ø§Ù„Ø³Ø¹Ø±|Ø§Ù„ÙƒÙ…ÙŠØ©|Ø±Ø§Ø¨Ø·_Ø§Ù„ØµÙˆØ±Ø©</code></li>
      </ul>
      <small>Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: <code>myzynoxxsecret</code></small>
    </div>
  </div>
</div>

<script>
/* ===== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (ØºÙŠÙ‘Ø± BOT_TOKEN Ùˆ CHAT_ID) ===== */
const BOT_TOKEN = "7682143795:AAFPjswfPRavrXeCvTpF0Lhy749w5Yo7cdk";
const CHAT_ID = "6497254308";
const PRODUCTS_URL = "./products.json";
const ADMIN_SECRET = "myzynoxxsecret";
/* =============================================== */

let products = [];
let cart = {};

const grid = document.getElementById('grid');
const noProducts = document.getElementById('noProducts');

async function loadProducts(){
  try{
    const res = await fetch(PRODUCTS_URL + '?t=' + Date.now());
    if(!res.ok) throw new Error('No products file');
    products = await res.json();
    renderProducts();
  }catch(e){
    console.warn(e);
    products = [];
    renderProducts();
  }
}

function renderProducts(){
  grid.innerHTML = '';
  if(!products.length){
    noProducts.style.display = 'block';
    return;
  } else noProducts.style.display = 'none';

  products.forEach(p=>{
    const card = document.createElement('div'); card.className='card';
    card.innerHTML = `
      <img src="${p.image||'https://via.placeholder.com/400x300?text=No+Image'}" alt="${escapeHtml(p.name)}" />
      <h3>${escapeHtml(p.name)}</h3>
      <div class="meta">
        <div class="price">${numberWithCommas(p.price)} DA</div>
        <div class="qty">Ø§Ù„Ù…ØªØ§Ø­: ${p.qty}</div>
      </div>
      <div style="color:var(--muted);font-size:13px">${escapeHtml(p.description||'')}</div>
      <div class="actions">
        <button class="addCart" ${p.qty<=0?'disabled':''} data-id="${p.id}">${p.qty>0?'Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©':'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</button>
        <button class="infoBtn" onclick="openImage('${encodeURIComponent(p.image||'')}')">ØµÙˆØ±Ø©</button>
      </div>
    `;
    grid.appendChild(card);
  });

  document.querySelectorAll('.addCart').forEach(btn=>{
    btn.onclick = (e)=>{
      const id = e.currentTarget.dataset.id;
      addToCart(id);
    }
  });
}

function openImage(img){
  if(!img) return;
  const url = decodeURIComponent(img);
  window.open(url,'_blank');
}

function addToCart(id){
  const p = products.find(x=>x.id==id);
  if(!p || p.qty<=0) return alert('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ±');
  if(!cart[id]) cart[id] = {...p, count:0};
  if(cart[id].count < p.qty) cart[id].count++;
  updateCartUI();
}

function numberWithCommas(x){ return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","); }
function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c])); }

function updateCartUI(){
  const cartDiv = document.getElementById('cart');
  const cartItems = document.getElementById('cartItems');
  const cartCount = document.getElementById('cartCount');
  const cartTotal = document.getElementById('cartTotal');

  const items = Object.values(cart);
  if(items.length===0){ cartDiv.style.display='none'; return; }
  cartDiv.style.display='block';
  cartItems.innerHTML = '';
  let total = 0; let count = 0;
  items.forEach(it=>{
    const row = document.createElement('div'); row.className='cartItem';
    row.innerHTML = `<img src="${it.image||'https://via.placeholder.com/80'}" alt=""><div style="flex:1"><strong>${escapeHtml(it.name)}</strong><div style="color:var(--muted);font-size:13px">${numberWithCommas(it.price)} DA Ã— ${it.count}</div></div>
      <div style="display:flex;flex-direction:column;gap:6px">
        <button onclick="dec('${it.id}')" class="infoBtn" style="padding:6px">âˆ’</button>
        <button onclick="inc('${it.id}')" class="infoBtn" style="padding:6px">+</button>
      </div>`;
    cartItems.appendChild(row);
    total += it.price * it.count;
    count += it.count;
  });
  cartCount.textContent = count;
  cartTotal.textContent = numberWithCommas(total) + ' DA';
}
function inc(id){ if(cart[id].count < cart[id].qty) cart[id].count++; updateCartUI(); }
function dec(id){ cart[id].count--; if(cart[id].count<=0) delete cart[id]; updateCartUI(); }

document.getElementById('closeCart').onclick = ()=>{ document.getElementById('cart').style.display='none'; }

document.getElementById('sendOrderBtn').onclick = async ()=>{
  const items = Object.values(cart);
  if(!items.length) return alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©');
  const name = prompt('Ø§Ø³Ù…Ùƒ:'); if(!name) return;
  const phone = prompt('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:'); if(!phone) return;

  let message = `ğŸ“¦ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…ÙˆÙ‚Ø¹ ZynoXx êœã‚\n\n`;
  message += `ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${name}\nğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: ${phone}\n\n`;
  message += `ğŸ›’ Ø§Ù„Ø¹Ù†Ø§ØµØ±:\n`;
  items.forEach(it=> message += `- ${it.name} Ã— ${it.count} = ${numberWithCommas(it.price*it.count)} DA\n`);
  const total = items.reduce((s,i)=> s + i.price * i.count, 0);
  message += `\nğŸ’° Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${numberWithCommas(total)} DA\n`;

  try{
    const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(message)}`;
    const res = await fetch(url);
    if(!res.ok) throw new Error('failed');
    alert('âœ” ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨. Ø³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.');
    cart = {}; updateCartUI();
  }catch(e){
    alert('âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª ÙÙŠ Ø§Ù„ÙƒÙˆØ¯.');
    console.error(e);
  }
};

const adminModal = document.getElementById('adminModal');
document.getElementById('adminOpen').onclick = ()=> adminModal.style.display='flex';
document.getElementById('adminClose').onclick = ()=> adminModal.style.display='none';
document.getElementById('adminLoad').onclick = ()=>{
  const secret = document.getElementById('adminSecret').value.trim();
  if(!secret) return alert('Ø§Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø¯ÙŠØ±');
  if(secret === ADMIN_SECRET){
    loadProducts();
    alert('âœ” ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª');
  } else alert('Ù…ÙØªØ§Ø­ ØºÙŠØ± ØµØ­ÙŠØ­');
}

document.getElementById('refreshBtn').onclick = ()=> loadProducts();
document.getElementById('search').addEventListener('input', function(){
  const q = this.value.trim().toLowerCase();
  if(!q) return renderProducts();
  grid.innerHTML = '';
  const filtered = products.filter(p => (p.name + ' ' + (p.description||'')).toLowerCase().includes(q));
  filtered.forEach(p => {
    const card = document.createElement('div'); card.className='card';
    card.innerHTML = `
      <img src="${p.image||'https://via.placeholder.com/400x300?text=No+Image'}" alt="${escapeHtml(p.name)}" />
      <h3>${escapeHtml(p.name)}</h3>
      <div class="meta">
        <div class="price">${numberWithCommas(p.price)} DA</div>
        <div class="qty">Ø§Ù„Ù…ØªØ§Ø­: ${p.qty}</div>
      </div>
      <div style="color:var(--muted);font-size:13px">${escapeHtml(p.description||'')}</div>
      <div class="actions">
        <button class="addCart" ${p.qty<=0?'disabled':''} data-id="${p.id}">${p.qty>0?'Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©':'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</button>
        <button class="infoBtn" onclick="openImage('${encodeURIComponent(p.image||'')}')">ØµÙˆØ±Ø©</button>
      </div>
    `;
    grid.appendChild(card);
  });
  document.querySelectorAll('.addCart').forEach(btn=> btn.onclick = (e)=> addToCart(e.currentTarget.dataset.id));
});

loadProducts();
</script>
</body>
</html>